# AI_Regression_with_inference
Car dataset: EDA, ML-model and FastApi service
Исходные данные - датасет о машинах. Цель - предсказать цену машины selling_price на основе данных (ее признаков).

1. Разведочный анализ данных
1) Данные
   В данной части данные были первично обработаны, очищены от пустот. Была произведена дедупликация, вещественные признаки были отформатированы (преведены к единой единце измерения в рамках одного столбца, разделены при необходимости на несколько столбцов). 
2) Анализ
   Были построены дашборды, распределения данных в попарных осях (признаках). Проведен корреляционный анализ, для вещественных признаков - корреляции Пирсона, Спирмена, для вещественных и категориальных - phik-корреляции.
   
   Результаты Пирсона/Спирмена
   Сильная положительная лин.зависимость наблюдается между признаками: - engine и max_power, corr = 0.68 - engine и torque, corr = 0.59 - engine и seats, corr = 0.65 - engine и selling_price(целевая переменная), corr = 0.45 - mileage vs year, cor = 0.34 Отрциательная корреляция между признакми, обратная линейная зависимость - engine vs mileage, corr = -0.57. То есть чем больше расход топлива, тем меньше engine - mileage vs seats, corr = -0.45 - mileage vs max_power, corr = -0.37 - year vs km_driven, corr = -0.37 Положительная корреляция целевой переменной selling price и признаками, лин.зависимость: - selling_price vs year, corr = 0.43 - selling_price vs engine, corr = 0.45 - selling_price vs max_power, corr = 0.69 - selling_price vs torque, corr = 0.47
   
   Результаты phik.
   Из новых зависимостей: - fuel vs mileage, engine, torque, max_torque_rpm - transmission vs engine, max_power, selling_price(целевая переменная!) - name vs все признаки, кроме km_driven, index. - owner vs year. Видимо в разные года преимущественно продавали определенные владельцы

2. Метрики качества моделей - R^2 и MSE

3. Были построены модели линейной регрессии на вещественных и категориальных признаках, применялись различные методы регуляризации (L1, L2, L0 и Elastic). Параметры регуляризации были подобраны оптимально с помощью GridSearchCV перебором по сетке KFold. Качество моделей с различными регуляризаторами оставалось константным - +-0.6. Качество модели довольно низкое, необходимо улучшать. Потенциально для улучшения модели можно попробовать логарифмирование целевой переменной  selling_price. Также можно поанализировать исходные данные на выбросы и удалить их, поскольку они могут зашумлять предсказательную способность модели.

4. Реализация сервиса FastApi
   Пример работы с сервисом в скринкасте vokoscreenNG-2024-12-03_22-39-40.mkv. Также продублировала видео в анитаск.

   Построили FastApi сервис с 2 запросами post:
   1) Предсказание selling_price по json, /predict_item
    Возвращается одно значение предсказания цены объекта selling price

Пример 1
- подаем json
![Screenshot from 2024-12-03 22-47-38](https://github.com/user-attachments/assets/abd61baa-0365-4680-903e-40066eba4972)

- получаем предсказание
![Screenshot from 2024-12-03 22-47-47](https://github.com/user-attachments/assets/3dc68ef4-ec04-4687-883c-b6062c0e44f9)


Пример 2
![Screenshot from 2024-12-03 20-11-43](https://github.com/user-attachments/assets/1ddcfe72-5cde-48b7-8d7e-54c8e500c3b1)
![Screenshot from 2024-12-03 20-11-51](https://github.com/user-attachments/assets/e1927015-b09c-419c-94ed-bbf3dbe2baa9)

   3) Предсказание selling_price коллекции объектов, /predict_items
      Принимается csv-файл, отдается также csv-файл с добавленным столбцом предсказанной цены selling price
Пример 3
- подаем данные data_test.csv 
![Screenshot from 2024-12-03 20-12-18](https://github.com/user-attachments/assets/77b01f89-ac31-4f42-ba1e-88327b13a17b)
- получаем предсказание 
![Screenshot from 2024-12-03 20-12-29](https://github.com/user-attachments/assets/8803742e-5348-44c4-864e-af1af44d5e6e)
      
